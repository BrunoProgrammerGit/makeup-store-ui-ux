<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Carrito de compras | EcoBeauty</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <header class="header">
        <div class="logo">
            <a href="index.html"> <img src="images/logo.png" alt="EcoBeauty Logo" style="height: 40px;"></a>
        </div>

        <nav class="header-actions">
            <button class="btn" id="open-auth">Iniciar sesión</button>
            <button class="btn btn-primary">Registrarse</button>
            <a href="car.html"><img src="images/car.png" alt="Carrito de compras" class="cart"></a>
            <span class="cart-count">0</span>
            <a href="userProfile.html"><img src="images/user.png" alt="Perfil de usuario" class="user"></a>
        </nav>

    </header>

    <div class="breadcrumb-container">
        <a href="index.html" class="breadcrumb-home" title="Inicio">
            <i class="fa-solid fa-house"></i>
        </a>
        <nav class="breadcrumb">
            &gt;
            <a href="products.html">Productos</a> &gt;
            <a href="product.html">Rocío vital</a>&gt;
            <a href="car.html">Carrito</a>

        </nav>
    </div>

    <main class="cart-main">
        <section class="cart-products" id="cart-products">
            <h1 class="cart-title">Carrito de compras</h1>
            <p class="cart-desc">Estos son los productos que has seleccionado:</p>
        </section>

        <aside class="cart-summary" id="cart-summary" style="display:none;">
            <h2>Resumen</h2>
            <div class="cart-summary-details" id="cart-summary-details"></div>
            <a href="checkout.html"><button class="btn btn-primary cart-checkout-btn">Finalizar compra</button></a>
            <div class="cart-payment-options">
                <span>Opciones de pago:</span>
                <div>
                    <i class="fa-brands fa-cc-visa"></i>
                    <i class="fa-brands fa-cc-mastercard"></i>
                    <i class="fa-brands fa-cc-amex"></i>
                    <i class="fa-brands fa-cc-paypal"></i>
                </div>
                <span class="eco-shipping">Envíos ecológicos disponibles</span>
            </div>
        </aside>
    </main>
    <div id="auth-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" id="close-auth">&times;</span>
            <h2 id="modal-title">Iniciar sesión</h2>
            <form>
                <input type="email" placeholder="Correo electrónico" required>
                <input type="password" placeholder="Contraseña" required>
                <button type="submit" class="btn btn-primary" style="width:100%;">Entrar</button>
            </form>
            <div style="text-align:center; margin: 10px 0;">o</div>
            <button class="btn google-btn" type="button" style="width:100%;">
                <i class="fa-brands fa-google"></i> Iniciar sesión con Google
            </button>
            <p id="toggle-auth" style="text-align:center; cursor:pointer; color:#007bff; margin-top:10px;">
                ¿No tienes cuenta? <span id="switch-to-register">Regístrate</span>
            </p>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="footer-contact">
                    <div class="footer-mail">
                        <i class="fa-regular fa-envelope"></i>
                        <a href="mailto:contacto@ecobeauty.com">contacto@ecobeauty.com</a>
                    </div>
                    <div class="footer-phone">
                        <i class="fa-solid fa-phone"></i>
                        <a href="tel:+573001234567">+57 300 123 4567</a>
                    </div>
                    <div class="footer-chat">
                        <i class="fa-regular fa-comments"></i>
                        <a href="#">Chatea con nosotros</a>
                    </div>
                </div>
                <div class="footer-columns">
                    <div class="footer-col">
                        <h4>Sobre Nosotros</h4>
                        <ul>
                            <li><a href="#">Nuestra historia</a></li>
                            <li><a href="#">Misión y visión</a></li>
                            <li><a href="#">Valores</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Ayuda</h4>
                        <ul>
                            <li><a href="#">Preguntas frecuentes</a></li>
                            <li><a href="#">Envíos</a></li>
                            <li><a href="#">Devoluciones</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Legal</h4>
                        <ul>
                            <li><a href="#">Términos y condiciones</a></li>
                            <li><a href="#">Política de privacidad</a></li>
                            <li><a href="#">Cookies</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-social-vertical">
                    <a href="#"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="#"><i class="fa-brands fa-linkedin"></i></a>
                </div>
            </div>
            <div class="footer-copy">
                &copy; 2025 EcoBeauty. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <script>
        function renderCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartProducts = document.getElementById('cart-products');
            const cartSummary = document.getElementById('cart-summary');
            const cartSummaryDetails = document.getElementById('cart-summary-details');
            let subtotal = 0;

            cartProducts.querySelectorAll('.cart-product-card, .cart-empty-msg').forEach(e => e.remove());

            if (cart.length === 0) {
                cartSummary.style.display = 'none';
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'cart-empty-msg';
                emptyMsg.innerHTML = '<p>Tu carrito está vacío.</p>';
                cartProducts.appendChild(emptyMsg);
                return;
            }

            cartSummary.style.display = '';
            cart.forEach(product => {
                const cleanPrice = Number(product.price.replace(/[^0-9]/g, ''));
                subtotal += product.qty * cleanPrice;
                const card = document.createElement('div');
                card.className = 'cart-product-card';
                card.innerHTML = `
                    <img src="${product.img}" alt="${product.name}" class="cart-product-img">
                    <div class="cart-product-info">
                        <div class="cart-product-row">
                            <span class="cart-product-name">${product.name}</span>
                            <span class="cart-product-price">${product.price}</span>
                            <button class="cart-remove-btn"><i class="fa fa-trash"></i></button>
                        </div>
                        <div class="cart-product-details">
                            <span>Cantidad:
                                <input type="number" min="1" value="${product.qty}" class="cart-qty-input">
                            </span>
                            <span>Eco envío</span>
                            <span>Certificación: ${product.certificaciones || 'EcoCert'}</span>
                        </div>
                    </div>
                `;
                cartProducts.appendChild(card);

                card.querySelector('.cart-remove-btn').onclick = function () {
                    const idx = cart.findIndex(item => item.name === product.name);
                    if (idx > -1) {
                        cart.splice(idx, 1);
                        localStorage.setItem('cart', JSON.stringify(cart));
                        renderCart();
                        updateCartCount();
                    }
                };

                card.querySelector('.cart-qty-input').onchange = function (e) {
                    const val = parseInt(e.target.value, 10);
                    if (val > 0) {
                        product.qty = val;
                        localStorage.setItem('cart', JSON.stringify(cart));
                        renderCart();
                        updateCartCount();
                    }
                };
            });

            const envio = cart.length > 0 ? 5000 : 0;
            const total = subtotal + envio;
            cartSummaryDetails.innerHTML = `
                <div class="cart-summary-row">
                    <span>Subtotal</span>
                    <span>$${subtotal.toLocaleString()}</span>
                </div>
                <div class="cart-summary-row">
                    <span>Envío ecológico</span>
                    <span>$${envio.toLocaleString()}</span>
                </div>
                <div class="cart-summary-row total">
                    <span>Total</span>
                    <span>$${total.toLocaleString()}</span>
                </div>
            `;
        }

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartCount = document.querySelector('.cart-count');
            if (cartCount) {
                let total = cart.reduce((sum, item) => sum + item.qty, 0);
                cartCount.textContent = total;
                cartCount.style.display = total > 0 ? 'inline-block' : 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            renderCart();
            updateCartCount();
        });
    </script>
    <script>
        document.querySelectorAll('.cart-remove-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const card = this.closest('.cart-product-card');
                if (card) card.remove();
            });
        });
    </script>
    <script>
        const authModal = document.getElementById('auth-modal');
        const closeAuth = document.getElementById('close-auth');
        const loginBtn = document.querySelector('.header-actions .btn');
        const registerBtn = document.querySelector('.header-actions .btn-primary');
        const modalTitle = document.getElementById('modal-title');
        const toggleAuth = document.getElementById('toggle-auth');

        loginBtn.addEventListener('click', function (e) {
            e.preventDefault();
            modalTitle.textContent = 'Iniciar sesión';
            toggleAuth.innerHTML = '¿No tienes cuenta? <span id="switch-to-register">Regístrate</span>';
            authModal.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('switch-to-register').onclick = showRegister;
            }, 10);
        });

        registerBtn.addEventListener('click', function (e) {
            e.preventDefault();
            modalTitle.textContent = 'Registrarse';
            toggleAuth.innerHTML = '¿Ya tienes cuenta? <span id="switch-to-login">Inicia sesión</span>';
            authModal.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('switch-to-login').onclick = showLogin;
            }, 10);
        });

        closeAuth.addEventListener('click', function () {
            authModal.classList.add('hidden');
        });

        function showRegister() {
            modalTitle.textContent = 'Registrarse';
            toggleAuth.innerHTML = '¿Ya tienes cuenta? <span id="switch-to-login">Inicia sesión</span>';
            document.getElementById('switch-to-login').onclick = showLogin;
        }
        function showLogin() {
            modalTitle.textContent = 'Iniciar sesión';
            toggleAuth.innerHTML = '¿No tienes cuenta? <span id="switch-to-register">Regístrate</span>';
            document.getElementById('switch-to-register').onclick = showRegister;
        }


        authModal.addEventListener('click', function (e) {
            if (e.target === authModal) authModal.classList.add('hidden');
        });
    </script>
    <script>

        (function () {

            const savedFontSize = localStorage.getItem('fontSize');
            if (savedFontSize) {
                document.documentElement.style.fontSize = savedFontSize + '%';
            }
            if (localStorage.getItem('highContrast') === 'true') {
                document.documentElement.classList.add('high-contrast');
            }
        })();
    </script>
</body>
<script>
        document.querySelectorAll('.cart-remove-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const card = this.closest('.cart-product-card');
                if (card) card.remove();
            });
        });
    </script>
<script>

        (function () {

            const savedFontSize = localStorage.getItem('fontSize');
            if (savedFontSize) {
                document.documentElement.style.fontSize = savedFontSize + '%';
            }
            if (localStorage.getItem('highContrast') === 'true') {
                document.documentElement.classList.add('high-contrast');
            }
        })();
    </script>
<script>
    (function () {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const cartCount = document.querySelector('.cart-count');
        if (cartCount) {
            let total = cart.reduce((sum, item) => sum + item.qty, 0);
            cartCount.textContent = total;
            cartCount.style.display = total > 0 ? 'inline-block' : 'none';
        }
    })();
</script>

</html>
